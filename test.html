<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√Årvore Conceitual: Auguste Comte (Aron)</title>
    <!-- Carregamento do Tailwind CSS para estilo e responsividade -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <!-- Tone.js para gera√ß√£o de √°udio cl√°ssico -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fc;
        }
        .concept-node {
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        .concept-node:hover {
            box-shadow: 0 0 15px rgba(79, 70, 229, 0.5); /* Sombra azul-√≠ndigo */
        }
        .concept-node.active {
            border-color: #4f46e5; /* Cor principal (Indigo 600) */
            background-color: #eef2ff; /* Fundo levemente azulado */
            font-weight: 600;
            color: #1e3a8a !important; /* Texto azul escuro para contraste no ativo */
        }
        .trunk {
            background-color: #4c1d95; /* Roxo escuro */
            color: white;
            border-bottom: 4px solid #fcd34d; /* Amarelo de destaque */
        }
        .branch-thick {
            background-color: #8b5cf6; /* Roxo m√©dio */
            color: white;
        }
        .branch-thin {
            background-color: #a78bfa; /* Roxo claro */
            color: white;
        }
        /* Responsividade para o layout principal */
        @media (min-width: 1024px) {
            #main-container {
                display: grid;
                grid-template-columns: 1fr 2fr; /* 1/3 para mapa, 2/3 para conte√∫do */
                gap: 2rem;
            }
        }
        /* Estilo espec√≠fico para o novo bloco de Cita√ß√£o */
        .citation-block {
            background-color: #ecfdf5; /* Fundo verde super claro */
            border-left: 4px solid #34d399; /* Borda verde forte */
            font-style: italic;
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div id="app" class="max-w-6xl mx-auto">

        <!-- Header e T√≠tulo -->
        <header class="text-center mb-8 relative">
            <h1 class="text-4xl font-extrabold text-indigo-800">Mapa Conceitual de Comte (Segundo Aron)</h1>
            <p class="text-gray-600 mt-2">Explore os conceitos de forma n√£o-linear, exercendo ag√™ncia total sobre sua trilha de estudos.</p>
        
            <!-- Bot√£o de Controle de M√∫sica -->
            <button id="music-btn" class="absolute top-0 right-0 p-2 bg-indigo-500 text-white rounded-full shadow-lg hover:bg-indigo-600 transition duration-300 flex items-center justify-center w-10 h-10" aria-label="Controlar M√∫sica">
                <span id="music-icon">üîá</span>
            </button>
        </header>

        <!-- Container Principal: Mapa Conceitual (Tronco e Galhos) -->
        <div id="main-container" class="lg:grid lg:gap-8">
            
            <!-- Coluna 1: Mapa Conceitual (√Årvore) -->
            <div id="concept-tree" class="bg-white p-4 sm:p-6 rounded-xl shadow-xl border border-indigo-100 mb-8 lg:mb-0">
                <h3 class="text-xl font-bold text-gray-800 mb-4 border-b pb-2">Estrutura (Tronco & Galhos)</h3>
                <!-- O mapa ser√° renderizado aqui -->
            </div>

            <!-- Coluna 2: Conte√∫do Denso e Cita√ß√µes -->
            <div id="content-display" class="content-card bg-white p-6 sm:p-10 rounded-xl shadow-2xl border border-indigo-200">
                <div id="content-header">
                    <h2 id="content-title" class="text-3xl font-extrabold text-gray-700 border-b pb-2 mb-4">Selecione um Galho para Come√ßar</h2>
                    <p id="content-key" class="text-sm text-indigo-500 mb-6">Escolha qualquer n√≥ no Mapa Conceitual √† esquerda (ou acima) para carregar o conte√∫do denso de estudo.</p>
                </div>
                
                <div id="content-body" class="text-base leading-relaxed text-gray-700 min-h-[300px]">
                    <p>Aqui aparecer√° o resumo aprofundado e as cita√ß√µes-chave de Raymond Aron sobre o t√≥pico selecionado. O aprendizado √© aut√¥nomo e n√£o-linear (Andragogia).</p>
                    <p class="mt-4 p-3 bg-yellow-50 rounded-lg text-yellow-800 border-l-4 border-yellow-500">Selecione o "Tronco" para ver a introdu√ß√£o e as ra√≠zes do pensamento de Comte, segundo Aron.</p>
                </div>

                <!-- NOVO BLOCO: Cita√ß√µes e Fonte Rastre√°vel (NotebookLM Style) -->
                <div id="citation-block" class="mt-10 pt-6 citation-block rounded-lg p-5 shadow-lg border border-green-200">
                    <h4 class="text-lg font-bold text-green-700 mb-3 flex items-center">
                        üìå Cita√ß√£o Rastre√°vel (Fonte)
                    </h4>
                    <div id="citation-content" class="text-sm text-gray-700 space-y-3">
                        <!-- Conte√∫do da cita√ß√£o ser√° injetado aqui -->
                    </div>
                </div>
                <!-- FIM NOVO BLOCO -->
            </div>
            
        </div>

    </div>

    <script>
        // Vari√°veis de Estado
        let activeNodeId = null;
        let musicPlaying = false;
        let ambientLoop; 

        // Estrutura Hier√°rquica (Tronco, Galhos Grossos, Galhos Finos)
        const conceptTree = [
            {
                id: 'T1',
                type: 'trunk',
                title: "O TRONCO: O FUNDAMENTO SOCIOL√ìGICO",
                key: "Introdu√ß√£o: Unidade vs. Diversidade",
                content: `
                    <h4 class="text-2xl font-semibold text-gray-800 mt-6 mb-4 border-b pb-2">Comte (Unidade) vs. Montesquieu (Diversidade)</h4>
                    <p class="text-gray-700 mb-4">Aron estabelece a diferen√ßa crucial: <strong>Montesquieu</strong> √© o soci√≥logo da <strong>diversidade</strong>, buscando a ordem no caos aparente dos determinantes sociais. <strong>Comte</strong>, ao contr√°rio, √© o soci√≥logo da <strong>unidade</strong>, levando sua concep√ß√£o a tal ponto que tem dificuldade em fundamentar a diversidade, pois toda a humanidade deve convergir para o mesmo tipo de sociedade (Positiva).</p>
                    
                    <div class="p-4 bg-red-100 border-l-4 border-red-500 text-red-800 rounded-lg mt-6 mb-4 shadow-sm">
                        <p class="font-bold">Ponto Cr√≠tico (Aron):</p>
                        <p class="text-sm italic mt-1">O foco inicial de Comte na unidade e na lei √∫nica da hist√≥ria (o determinismo) √©, ironicamente, a principal limita√ß√£o de sua sociologia, for√ßando a realidade a caber em um molde r√≠gido.</p>
                    </div>
                `,
                // Cita√ß√£o baseada na p√°gina 9 do livro de Aron
                citation: {
                    source: "ARON, As Etapas do Pensamento Sociol√≥gico, p. 9",
                    excerpt: "Montesquieu √©, antes de tudo, o soci√≥logo consciente da diversidade... Auguste Comte, ao contr√°rio, √© antes de mais nada o soci√≥logo da unidade humana e social, da unidade da hist√≥ria humana."
                },
                children: ['G1', 'G2', 'G3', 'S1']
            },
            {
                id: 'G1',
                type: 'branch-thick',
                title: "1¬™ ETAPA: POSITIVISMO CIENT√çFICO PURO",
                key: "O Plano Puramente Intelectual (1822-1826)",
                content: `
                    <h4 class="text-2xl font-semibold text-gray-800 mt-6 mb-4 border-b pb-2">A Organiza√ß√£o pela Ci√™ncia</h4>
                    <p class="text-gray-700 mb-4">Nesta fase, Comte acredita que a reorganiza√ß√£o da sociedade moderna deve ser baseada <strong>exclusivamente na ci√™ncia positiva</strong>, que se torna o √∫nico conhecimento v√°lido. O sistema √© puramente cient√≠fico e rejeita a teologia e a metaf√≠sica por gerarem o caos p√≥s-Revolu√ß√£o Francesa.</p>
                    <p class="text-gray-700 italic mt-4">Essa √© a fase da funda√ß√£o l√≥gica da Sociologia.</p>
                `,
                children: ['F1-1', 'F1-2']
            },
            {
                id: 'F1-1', 
                type: 'branch-thin', 
                key: "Lei dos Tr√™s Estados", 
                content: `
                    <div class="p-5 bg-blue-50 border-l-4 border-blue-400 rounded-lg shadow-md mb-4">
                        <p class="text-lg font-bold text-blue-800 mb-2">Detalhe da Lei:</p>
                        <p class="text-gray-700">A sucess√£o necess√°ria das formas de conhecimento (Teol√≥gico, Metaf√≠sico, Positivo). √â a chave da Din√¢mica Social (progresso).</p>
                        <p class="mt-2 text-sm italic text-gray-600">No Estado Positivo, o esp√≠rito renuncia a buscar a origem e o destino dos fen√¥menos, limitando-se a descobrir as leis de sucess√£o e semelhan√ßa.</p>
                    </div>
                `, 
                children: []
            },
            {
                id: 'F1-2', 
                type: 'branch-thin', 
                key: "Hierarquia das Ci√™ncias", 
                content: `
                    <div class="p-5 bg-blue-50 border-l-4 border-blue-400 rounded-lg shadow-md mb-4">
                        <p class="text-lg font-bold text-blue-800 mb-2">Ordem Cient√≠fica:</p>
                        <p class="text-gray-700">Ordem crescente de complexidade e decrescente de generalidade (Matem√°tica ‚Üí Biologia ‚Üí Sociologia).</p>
                        <p class="mt-2 text-sm italic text-gray-600">A Sociologia √© a 'rainha' das ci√™ncias, a √∫ltima a entrar no estado positivo, por ser a mais complexa.</p>
                    </div>
                `, 
                children: []
            },
            {
                id: 'G2',
                type: 'branch-thick',
                title: "2¬™ ETAPA: SISTEMATIZA√á√ÉO SOCIOL√ìGICA",
                key: "A Divis√£o de Est√°tica e Din√¢mica Social (1826-1845)",
                content: `
                    <h4 class="text-2xl font-semibold text-gray-800 mt-6 mb-4 border-b pb-2">A Separa√ß√£o entre Ordem e Progresso</h4>
                    <p class="text-gray-700 mb-6">Comte formaliza a Sociologia em dois ramos que correspondem √†s duas grandes quest√µes do social:</p>
                    <ul class="list-disc list-inside space-y-3 ml-4 text-gray-700 p-4 bg-gray-100 rounded-xl border border-gray-200 shadow-inner">
                        <li class="font-bold text-indigo-700">Est√°tica Social: <span class="font-normal text-gray-800">O estudo da <strong>Ordem</strong> e das condi√ß√µes de exist√™ncia das sociedades. Foca nas leis da coexist√™ncia e na estrutura social.</span></li>
                        <li class="font-bold text-indigo-700">Din√¢mica Social: <span class="font-normal text-gray-800">O estudo do <strong>Progresso</strong> e do movimento cont√≠nuo da humanidade (a Lei dos Tr√™s Estados em a√ß√£o). Foca nas leis de sucess√£o.</span></li>
                    </ul>
                `,
                children: ['F2-1', 'F2-2', 'F2-3']
            },
            {
                id: 'F2-1', 
                type: 'branch-thin', 
                key: "Cr√≠tica √† Metaf√≠sica ('Nefasta')", 
                content: `
                    <div class="p-5 bg-yellow-50 border-l-4 border-yellow-400 rounded-lg shadow-md mb-4">
                        <p class="text-lg font-bold text-yellow-800 mb-2">Fase de Transi√ß√£o (Caos):</p>
                        <p class="text-gray-700">Comte critica a fase Metaf√≠sica por ser apenas destrutiva. Ela destr√≥i o Teol√≥gico em nome de abstra√ß√µes, mas n√£o possui for√ßa construtiva, mantendo a anarquia social.</p>
                    </div>
                `, 
                children: []
            },
            {
                id: 'F2-2', 
                type: 'branch-thin', 
                key: "Est√°tica (A Ordem)", 
                content: `
                    <div class="p-5 bg-green-50 border-l-4 border-green-400 rounded-lg shadow-md mb-4">
                        <p class="text-lg font-bold text-green-800 mb-2">Foco da Est√°tica:</p>
                        <p class="text-gray-700">Foco nas institui√ß√µes que garantem a coes√£o: fam√≠lia, linguagem, divis√£o do trabalho e religi√£o. A <strong>Ordem</strong> √© a base de todo Progresso.</p>
                    </div>
                `, 
                children: []
            },
            {
                id: 'F2-3', 
                type: 'branch-thin', 
                key: "Din√¢mica (O Progresso)", 
                content: `
                    <div class="p-5 bg-red-50 border-l-4 border-red-400 rounded-lg shadow-md mb-4">
                        <p class="text-lg font-bold text-red-800 mb-2">Mecanismo do Progresso:</p>
                        <p class="text-gray-700">A Lei dos Tr√™s Estados √© a lei fundamental do Progresso. A pol√≠tica positiva deve apenas 'iluminar' a marcha necess√°ria da humanidade, n√£o cri√°-la (determinismo hist√≥rico).</p>
                    </div>
                `, 
                // Cita√ß√£o direta de Comte (citada em Aron, p. 9)
                citation: {
                    source: "Comte, Syst√®me de politique positive, Ap√™ndice III, 1828, p. 95 (citado em Aron, p. 9)",
                    excerpt: "A sua pol√≠tica n√£o deveria ter por objeto fazer avan√ßar a esp√©cie humana, que se move por impulso pr√≥prio, seguindo uma lei t√£o necess√°ria quanto a da gravidade... ela tem por finalidade facilitar sua marcha, iluminando-a."
                },
                children: []
            },
            {
                id: 'G3',
                type: 'branch-thick',
                title: "3¬™ ETAPA: RELIGI√ÉO DA HUMANIDADE",
                key: "O Sistema Completo e a Virada Moral (P√≥s-1845)",
                content: `
                    <h4 class="text-2xl font-semibold text-gray-800 mt-6 mb-4 border-b pb-2">A Virada do Cientificismo ao Altru√≠smo</h4>
                    <p class="text-gray-700 mb-4">A fase final do pensamento de Comte, marcada pela paix√£o por Clotilde de Vaux. O sistema deixa de ser puramente cient√≠fico e torna-se a <strong>Religi√£o da Humanidade</strong>.</p>
                    
                    <div class="p-5 bg-indigo-50 border-l-4 border-indigo-500 text-indigo-800 rounded-lg mt-6 mb-4 shadow-sm">
                        <p class="font-bold">Finalidade Social:</p>
                        <p class="text-sm italic mt-1">Substituir o papel social e moral da Igreja Cat√≥lica. O sistema precisa de um <strong>culto moral</strong> para garantir a unidade social e a subordina√ß√£o do Ego√≠smo ao Altru√≠smo. O lema 'Viver para Outrem' √© central.</p>
                    </div>
                `,
                children: ['F3-1', 'F3-2']
            },
            {
                id: 'F3-1', 
                type: 'branch-thin', 
                key: "O Grande Ser (A Humanidade)", 
                content: `
                    <div class="p-5 bg-purple-50 border-l-4 border-purple-400 rounded-lg shadow-md mb-4">
                        <p class="text-lg font-bold text-purple-800 mb-2">Objeto de Culto:</p>
                        <p class="text-gray-700">A Humanidade √© o objeto de culto e venera√ß√£o. √â a soma dos seres que contribu√≠ram para o Progresso. √â um conceito coletivo de imortalidade subjetiva.</p>
                    </div>
                `, 
                children: []
            },
            {
                id: 'F3-2', 
                type: 'branch-thin', 
                key: "O Sacerdote da Nova Ordem", 
                content: `
                    <div class="p-5 bg-red-50 border-l-4 border-red-400 rounded-lg shadow-md mb-4">
                        <p class="text-lg font-bold text-red-800 mb-2">Cr√≠tica de Aron:</p>
                        <p class="text-gray-700">Nesta fase, Comte age mais como um Sacerdote da nova Ordem Positivista. Aron critica a fus√£o da ci√™ncia com a doutrina pol√≠tica, levando √† 'deforma√ß√£o' final do Positivismo, que se torna totalit√°rio em sua ambi√ß√£o.</p>
                    </div>
                `, 
                children: []
            },
            {
                id: 'S1',
                type: 'trunk',
                title: "S√çNTESE FINAL: O LEGADO DE COMTE",
                key: "Cientista vs. Reformador Social",
                content: `
                    <h4 class="text-2xl font-semibold text-gray-800 mt-6 mb-4 border-b pb-2">Conclus√£o de Aron: A Ambiguidade de Comte</h4>
                    <p class="text-gray-700 mb-6">Aron reconhece que a maior contribui√ß√£o de Comte foi fundar a Sociologia, mas sua ambi√ß√£o de totalidade o levou a uma doutrina determinista.</p>
                    
                    <ul class="list-disc list-inside space-y-3 ml-4 text-gray-700 p-4 bg-gray-100 rounded-xl border border-gray-200 shadow-inner mb-6">
                        <li class="font-bold text-green-700">Cientista: <span class="font-normal text-gray-800">Inventou o nome Sociologia e o m√©todo positivo para o social.</span></li>
                        <li class="font-bold text-red-700">Reformador: <span class="font-normal text-gray-800">Criou uma religi√£o/doutrina moral para garantir o consenso.</span></li>
                    </ul>
                    
                    <div class="p-4 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 rounded-lg shadow-sm">
                        <p class="font-bold">Legado Contradit√≥rio:</p>
                        <p class="text-sm italic mt-1">A Sociologia moderna aceitou o m√©todo cient√≠fico, mas rejeitou seu projeto final de reforma teocr√°tica e moral, que nega a liberdade e a conting√™ncia hist√≥rica.</p>
                    </div>
                `,
                // Cita√ß√£o sobre as 3 etapas
                citation: {
                    source: "ARON, As Etapas do Pensamento Sociol√≥gico, p. 11",
                    excerpt: "Parece-me que podemos apresentar as etapas da evolu√ß√£o filos√≥fica de Auguste Comte como representando as tr√™s formas pelas quais a sociologia se apresenta aos soci√≥logos: a ci√™ncia pura, a filosofia moral e pol√≠tica, e, enfim, a religi√£o."
                },
                children: []
            }
        ];

        // Mapeamento plano para facilitar a busca por ID
        let nodeMap = {};

        // --- Fun√ß√µes de √Åudio (Tone.js) ---
        async function startAmbientMusic() {
            await Tone.start(); 
            const synth = new Tone.Synth({
                oscillator: { type: "sine" },
                envelope: { attack: 0.1, decay: 0.2, sustain: 0.5, release: 0.8 }
            }).toDestination();
            Tone.Destination.volume.value = -12; 
            const notes = ["C4", "G3", "A3", "F3"]; 
            let noteIndex = 0;
            // Corrigido o loop para usar '1m' para um andamento mais lento e contemplativo (40 BPM)
            ambientLoop = new Tone.Loop(time => { 
                const note = notes[noteIndex % notes.length];
                synth.triggerAttackRelease(note, "2n", time);
                noteIndex++;
            }, "1m").start(0);
            Tone.Transport.bpm.value = 40; 
            Tone.Transport.start();
            musicPlaying = true;
            document.getElementById('music-icon').textContent = 'üîä';
        }

        function stopAmbientMusic() {
            if (ambientLoop) {
                ambientLoop.stop();
                // Pausar o transporte, mas manter o objeto Tone.js
                Tone.Transport.stop(); 
            }
            musicPlaying = false;
            document.getElementById('music-icon').textContent = 'üîá';
        }

        document.getElementById('music-btn').addEventListener('click', () => {
            if (musicPlaying) {
                stopAmbientMusic();
            } else {
                startAmbientMusic();
            }
        });
        // --- Fim Setup de √Åudio ---

        /**
         * Cria o mapeamento plano de n√≥s para busca r√°pida.
         */
        function buildNodeMap(nodes) {
            nodes.forEach(node => {
                nodeMap[node.id] = node;
            });
        }
        
        /**
         * Gera recursivamente o mapa conceitual (Tronco, Galhos, Folhas).
         */
        function renderTree(parentId, level = 0) {
            const parentNode = nodeMap[parentId];
            if (!parentNode || !parentNode.children) return '';

            // Usa 'ml-4' para recuo visual dos sub-galhos
            let html = `<ul class="${level > 0 ? 'ml-4 mt-2 space-y-2 border-l border-indigo-300 pl-4' : 'space-y-3'}">`;

            parentNode.children.forEach(childId => {
                const node = nodeMap[childId];

                let nodeClass = 'bg-gray-200 text-gray-800';
                let icon = 'üìñ';
                if (node.type === 'trunk') {
                    nodeClass = 'trunk text-white font-extrabold';
                    icon = 'üå≥';
                } else if (node.type === 'branch-thick') {
                    nodeClass = 'branch-thick text-white font-bold';
                    icon = 'üåø';
                } else if (node.type === 'branch-thin') {
                    nodeClass = 'branch-thin text-white font-medium';
                    icon = 'üçÉ';
                }

                // A classe 'active' N√ÉO √© aplicada aqui, pois ser√° manipulada dinamicamente
                html += `<li>
                    <div 
                        id="node-${node.id}"
                        class="concept-node p-3 rounded-lg shadow-md ${nodeClass}"
                        data-id="${node.id}"
                        onclick='displayContentById("${node.id}")'
                    >
                        <span class="mr-2">${icon}</span> ${node.key}
                    </div>`;

                // Renderiza os filhos (galhos menores) recursivamente
                if (node.children && node.children.length > 0) {
                    html += renderTree(node.id, level + 1);
                }

                html += `</li>`;
            });
            
            html += `</ul>`;
            return html;
        }

        /**
         * Fun√ß√£o wrapper para buscar o objeto de dados pelo ID e chamar displayContent.
         */
        function displayContentById(id) {
            const data = nodeMap[id];
            if (data) {
                displayContent(data);
            } else {
                console.error("Erro: N√≥ n√£o encontrado para o ID:", id);
            }
        }

        /**
         * Exibe o conte√∫do do n√≥ (galho) clicado no painel da direita e gerencia o estado 'active'.
         */
        function displayContent(data) {
            const { id, key, title, content, citation } = data;
            
            // 1. L√≥gica de atualiza√ß√£o de estado ativo (Otimizada)
            const oldActiveNode = document.getElementById(`node-${activeNodeId}`);
            if (oldActiveNode) {
                oldActiveNode.classList.remove('active');
            }

            // 2. Atualizar o ID ativo
            activeNodeId = id;

            // 3. Aplicar classe 'active' ao novo n√≥
            const newActiveNode = document.getElementById(`node-${activeNodeId}`);
            if (newActiveNode) {
                newActiveNode.classList.add('active');
            }
            
            // 4. Inserir o novo conte√∫do principal
            document.getElementById('content-title').textContent = title;
            document.getElementById('content-key').textContent = key;
            document.getElementById('content-body').innerHTML = content;

            // 5. Inserir a cita√ß√£o rastre√°vel (Novo)
            const citationBlock = document.getElementById('citation-content');
            if (citation && citation.source && citation.excerpt) {
                citationBlock.innerHTML = `
                    <p class="mb-3 p-3 bg-white rounded shadow-sm text-base text-gray-800 border-l-2 border-green-500">${citation.excerpt}</p>
                    <p class="text-xs font-semibold text-green-700 mt-2">Fonte: ${citation.source}</p>
                `;
            } else {
                citationBlock.innerHTML = `
                    <p class="text-sm text-gray-500 p-2">Nenhuma cita√ß√£o rastre√°vel direta dispon√≠vel para este t√≥pico. Foco no resumo interpretativo de Aron.</p>
                `;
            }
        }

        /**
         * Renderiza um √∫nico n√≥ (usado para o Tronco T1, que n√£o tem pai).
         */
        function renderNode(node) {
            let nodeClass = 'trunk text-white font-extrabold';
            let icon = 'üå≥';
            
            return `<div 
                id="node-${node.id}"
                class="concept-node p-3 rounded-lg shadow-md ${nodeClass}"
                data-id="${node.id}"
                onclick='displayContentById("${node.id}")'
            >
                <span class="mr-2">${icon}</span> ${node.key}
            </div>`;
        }


        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', () => {
            // 1. Constr√≥i o mapa de busca (necess√°rio para a recurs√£o)
            buildNodeMap(conceptTree);
            
            // 2. Define o n√≥ inicial
            const trunkNode = conceptTree[0];
            activeNodeId = trunkNode.id;

            // 3. Renderiza a ESTRUTURA da √°rvore UMA VEZ
            const treeContainer = document.getElementById('concept-tree');
            treeContainer.innerHTML = `<h3 class="text-xl font-bold text-gray-800 mb-4 border-b pb-2">Estrutura (Tronco & Galhos)</h3>`;
            treeContainer.innerHTML += renderNode(trunkNode);
            treeContainer.innerHTML += renderTree(trunkNode.id);

            // 4. Usa displayContentById para carregar o conte√∫do inicial de T1 e aplicar a classe 'active'
            displayContentById(trunkNode.id);
        });
    </script>
</body>
</html>